<!DOCTYPE html>
<html lang="en" class="pf-m-redhat-font">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="fonts.css" />
    <!-- Include latest PatternFly CSS via CDN -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/@patternfly/patternfly/patternfly.css"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />
    <title>PatternFly Primary-detail expanded CodeSandbox Example</title>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <script>



      var app = angular.module('myApp', []);
      app.controller('FormController', function($scope,$http) {

      var baseURL = window.location.protocol + '//' + window.location.host;
      var queryString = window.location.search;
var urlParams = new URLSearchParams(queryString);
var taskId = urlParams.get('taskId');
var caseId = urlParams.get('caseId');


        $http({
        url: baseURL+"/onboarding/docReq/"+caseId,
        method: "GET"

    })
    .then(function(response) {

           $scope.docReq =response.data;




    });
       $scope.files = [];

     $scope.getFileDetails = function (e) {


            $scope.$apply(function () {

                // STORE THE FILE OBJECT IN AN ARRAY.
                for (var i = 0; i < e.files.length; i++) {
                    $scope.files.push(e.files[i])
                }

            });
        };

$scope.uploadFiles = function () {

        $scope.test = "assigned";

            //FILL FormData WITH FILE DETAILS.
            var data = new FormData();

            for (var i in $scope.files) {
                data.append("uploadedFile", $scope.files[i]);
            }




            $http({
            url: baseURL+'/onboarding/customer-case/documents/'+caseId+'/task/'+taskId,
            method: "POST",
            data: data,
             headers: {'Content-Type': undefined},
            })
            .then(function(response) {
              $scope.responseMsg = "Files Uploaded Succesfully, we will be with you shortly";
              $scope.test="unassigned";
            });

}

         });



 </script>

  </head>


  <body ng-app="myApp" ng-controller="FormController">
    <div class="pf-c-page" id="primary-detail-expanded-example">
      <a
        class="pf-c-skip-to-content pf-c-button pf-m-primary"
        href="#main-content-primary-detail-expanded-example"
        >Skip to content</a
      >
      <header class="pf-c-page__header">
        <div class="pf-c-page__header-brand">
          <div class="pf-c-page__header-brand-toggle">
            <button
              class="pf-c-button pf-m-plain"
              type="button"
              id="primary-detail-expanded-example-nav-toggle"
              aria-label="Global navigation"
              aria-expanded="true"
              aria-controls="primary-detail-expanded-example-primary-nav"
            >
              <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
          </div>
          <a href="#" class="pf-c-page__header-brand-link">
            <img

                    src="logo.png" width="105px"
                    alt="PatternFly logo"
            />
          </a>
        </div>

        <div class="pf-c-page__header-tools">
          <div class="pf-c-page__header-tools-group">
            <div
              class="pf-c-page__header-tools-item pf-m-hidden pf-m-visible-on-lg"
            >
              <button
                class="pf-c-button pf-m-plain"
                type="button"
                aria-label="Settings"
              >
                <i class="fas fa-cog" aria-hidden="true"></i>
              </button>
            </div>
            <div
              class="pf-c-page__header-tools-item pf-m-hidden pf-m-visible-on-lg"
            >
              <button
                class="pf-c-button pf-m-plain"
                type="button"
                aria-label="Help"
              >
                <i class="pf-icon pf-icon-help" aria-hidden="true"></i>
              </button>
            </div>
          </div>
          <div class="pf-c-page__header-tools-group">
            <div class="pf-c-page__header-tools-item pf-m-hidden-on-lg">
              <div class="pf-c-dropdown">
                <ul
                  class="pf-c-dropdown__menu pf-m-align-right"
                  aria-labelledby="primary-detail-expanded-example-dropdown-kebab-1-button"
                  hidden
                >
                  <li></li>
                  <li>
                    <a
                      class="pf-c-dropdown__menu-item pf-m-disabled"
                      href="#"
                      aria-disabled="true"
                      tabindex="-1"
                      >Disabled link</a
                    >
                  </li>
                  <li>
                    <button
                      class="pf-c-dropdown__menu-item"
                      type="button"
                      disabled
                    >
                      Disabled action
                    </button>
                  </li>
                  <li class="pf-c-divider" role="separator"></li>
                  <li>
                    <a class="pf-c-dropdown__menu-item" href="#"
                      >Separated link</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div
              class="pf-c-page__header-tools-item pf-m-hidden pf-m-visible-on-md"
            >
              <div class="pf-c-dropdown">
                <button
                  class="pf-c-dropdown__toggle pf-m-plain"
                  id="primary-detail-expanded-example-dropdown-kebab-2-button"
                  aria-expanded="false"
                  type="button"
                >
                  <span class="pf-c-dropdown__toggle-text">John Smith</span>
                  <span class="pf-c-dropdown__toggle-icon">
                    <i class="fas fa-caret-down" aria-hidden="true"></i>
                  </span>
                </button>
                <ul
                  class="pf-c-dropdown__menu"
                  aria-labelledby="primary-detail-expanded-example-dropdown-kebab-2-button"
                  hidden
                >
                  <li>
                    <a class="pf-c-dropdown__menu-item" href="#">Link</a>
                  </li>
                  <li></li>
                  <li>
                    <a
                      class="pf-c-dropdown__menu-item pf-m-disabled"
                      href="#"
                      aria-disabled="true"
                      tabindex="-1"
                      >Disabled link</a
                    >
                  </li>
                  <li>
                    <button
                      class="pf-c-dropdown__menu-item"
                      type="button"
                      disabled
                    >
                      Disabled action
                    </button>
                  </li>
                  <li class="pf-c-divider" role="separator"></li>
                  <li>
                    <a class="pf-c-dropdown__menu-item" href="#"
                      >Separated link</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <img
            class="pf-c-avatar"
            src="https://www.patternfly.org/v4/assets/images/img_avatar.svg"
            alt="Avatar image"
          />
        </div>
      </header>
      <div class="pf-c-page__sidebar">
        <div class="pf-c-page__sidebar-body">
          <nav
            class="pf-c-nav"
            id="primary-detail-expanded-example-primary-nav"
            aria-label="Global"
          >
            <ul class="pf-c-nav__list">
              <li class="pf-c-nav__item">
                <a
                  href="#"
                  class="pf-c-nav__link pf-m-current"
                  aria-current="page"
                  >Commercial Onboarding</a
                >
              </li>
            </ul>
          </nav>
        </div>
      </div>
      <main class="pf-c-page__main" tabindex="-1">
        <section class="pf-c-page__main-section pf-m-light">
          <div class="pf-c-content">
            <h2>Documentation Requirements</h2>
          </div>
        </section>

        <div class="pf-c-divider" role="separator"></div>
        <section class="pf-c-page__main-section pf-m-no-padding">
          <!-- Drawer -->
          <div class="pf-c-drawer pf-m-expanded pf-m-inline-on-4xl">
            <div class="pf-c-drawer__main">
              <!-- Content -->
              <div class="pf-c-drawer__content">
                <div class="pf-c-drawer__body">
                  <ul
                    class="pf-c-data-list"
                    role="list"
                    aria-label="Simple data list example"
                    id="primary-detail-expanded-example-data-list"
                  >
                    <li
                      class="pf-c-data-list__item"
                      aria-labelledby="primary-detail-expanded-example-data-list-item-1"
                    >
                      <div class="pf-c-data-list__item-row">
                        <div class="pf-c-data-list__item-content">
                          <div class="pf-c-data-list__cell pf-m-align-left">
                            <div
                              class="pf-l-flex pf-m-column pf-m-space-items-md"
                            >
                              <div
                                class="pf-l-flex pf-m-column pf-m-space-items-none"
                              >
                                <form enctype="multipart/form-data">

                                <table  class="pf-c-table pf-m-grid-md" id="table1" ng-show="docReq != null">
                                  <thead>
                                  <tr role="row">
                                    <th role="columnheader">Document Name</th>
                                    <th role="columnheader">Upload</th>


                                  </tr>
                                  </thead>

                                  <tbody ng-repeat="x in docReq" role="rowgroup">

                                  <tr role="row"><td role="cell">{{x.docName}}</td><td><div class="file-loading">
                                    <input id="file-1" type="file" showClose="false" data-show-upload="false" multiple class="file" data-theme="fas" onchange="angular.element(this).scope().getFileDetails(this)" >

                                  </div></td></tr>

                                  </tr>
                                  </tbody>

                                </table>
                                  <br/>

                                  <button id="submitButton"  type="button"  class="pf-c-button pf-m-primary" ng-click="uploadFiles();" ng-show="responseMsg == null">Submit</button>
                                </form>

                                <br/>
                               <p> {{responseMsg}}</p>
                              </div>

                            </div>
                          </div>
                          <div
                            class="pf-c-data-list__cell pf-m-align-right pf-m-no-fill"
                          ></div>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>


            </div>
          </div>
        </section>
      </main>
    </div>
  </body>
</html>
